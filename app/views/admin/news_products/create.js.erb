(function(){
	<%if @called_from == "news" %>
		<%= render "/admin/news_products/rebuild_product_list" %>
	<% end %>	

	var $list_of_associated_products = $('#news_products');

	build_list_of_products_associated_with_this_software($list_of_associated_products);

	function build_list_of_products_associated_with_this_software($list_of_associated_products) {
		<% if @news_products.present? %>
			<% @news_products.each do |news_product| %>
				$list_of_associated_products.append('<%= escape_javascript(render "/admin/shared/news_product_row", np: news_product, called_from: @called_from) %>');
			<% end %>	
		<% else %>
				$list_of_associated_products.append('<%= escape_javascript(render "/admin/shared/news_product_row", np: @news_product, called_from: @called_from) %>');
		<% end %>
	}  //  function build_list_of_products_associated_with_this_site_element($list_of_associated_products)
})();

<% flash.discard %>